 function  [bp, wls] = a1_preprocessing(data, user)
  
 

%--------------------Number of Variable and Factor Nodes-------------------
 [bp] = a2_num_var_fac(data);
%--------------------------------------------------------------------------


%--------------------------Local Factor Nodes------------------------------
 [bp] = a3_local_factor(data, user, bp);
%--------------------------------------------------------------------------


%------------------------Indirect Factor Nodes-----------------------------
 [bp] = a4_indirect_factor(data, bp);
%--------------------------------------------------------------------------


%-------------------------Convergence Parameters---------------------------
 [bp] = a5_converg(user, bp);
%--------------------------------------------------------------------------


%-------------------------Expand for BP Summation--------------------------
 [bp] = a6_messages_sum(bp);
%--------------------------------------------------------------------------


%---------------------------------WLS--------------------------------------
 [wls] = a7_wls(data, bp);
%--------------------------------------------------------------------------


%--------------------------Check Connectivity------------------------------
 [bp] = a8_connect(bp);
%--------------------------------------------------------------------------